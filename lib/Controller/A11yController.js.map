{"version":3,"sources":["../../src/Controller/A11yController.js"],"names":["A11yController","constructor","args","logger","Logger","start","callback","event","progress","Promise","resolve","reject","output","doesFolderExist","optionsRepository","OptionsRepository","option","getOption","urlsRepository","UrlsRepository","urls","findAll","pa11yRepository","Pa11yRepository","test","report","toLog","verbose","console","log","toString","then","catch","exception","currentUrl","addError"],"mappings":";;;;;;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;;;AAEA;AACe,MAAMA,cAAN,CAAqB;AAMhCC,EAAAA,WAAW,CAACC,IAAD,EAAa;AACpB,SAAKA,IAAL,GAAYA,IAAZ;AACA,SAAKC,MAAL,GAAc,IAAIC,eAAJ,CAAWF,IAAX,CAAd;AACH;;AAEDG,EAAAA,KAAK,GAA8D;AAAA,QAA7DC,QAA6D,uEAAxC,CAACC,KAAD,EAAQC,QAAR,KAAqB,CAAE,CAAiB;AAC/D,WAAO,IAAIC,OAAJ,CAAY,CAACC,OAAD,EAAUC,MAAV,KAAqB;AACpC,WAAKT,IAAL,CAAUU,MAAV,CAAiBC,eAAjB,GADoC,CAEpC;;AACA,UAAIC,iBAAiB,GAAG,IAAIC,0BAAJ,CAAsB,KAAKb,IAA3B,CAAxB;AACA,UAAIc,MAAM,GAAGF,iBAAiB,CAACG,SAAlB,EAAb,CAJoC,CAMpC;;AACA,UAAIC,cAAc,GAAG,IAAIC,uBAAJ,CAAmBH,MAAnB,EAA2B,KAAKd,IAAhC,CAArB;AACA,WAAKkB,IAAL,GAAYF,cAAc,CAACG,OAAf,EAAZ,CARoC,CAUpC;;AACA,WAAKC,eAAL,GAAuB,IAAIC,wBAAJ,CAAoBP,MAApB,EAA4B,KAAKd,IAAjC,CAAvB;AAEA,WAAKsB,IAAL,CAAUlB,QAAV,EAAoBI,OAApB;AACH,KAdM,CAAP;AAeH;;AAEDc,EAAAA,IAAI,GAA6E;AAAA,QAA5ElB,QAA4E,uEAAvD,CAACC,KAAD,EAAQC,QAAR,KAAqB,CAAE,CAAgC;AAAA,QAA9BE,OAA8B,uEAAV,MAAM,CAAE,CAAE;AAC7E,SAAKY,eAAL,CAAqBE,IAArB,CAA0B,KAAKJ,IAA/B,EAAsCZ,QAAD,IAAwB;AACzDF,MAAAA,QAAQ,CAAC,OAAD,EAAUE,QAAV,CAAR;AACA,WAAKL,MAAL,CAAYsB,MAAZ,CAAmBjB,QAAQ,CAACkB,KAAT,EAAnB;;AACA,UAAI,KAAKxB,IAAL,CAAUyB,OAAd,EAAuB;AACnBC,QAAAA,OAAO,CAACC,GAAR,CAAYrB,QAAQ,CAACsB,QAAT,EAAZ;AACH;AACJ,KAND,EAMItB,QAAD,IAAwB;AACvBF,MAAAA,QAAQ,CAAC,UAAD,EAAaE,QAAb,CAAR;AACA,WAAKL,MAAL,CAAYsB,MAAZ,CAAmBjB,QAAQ,CAACkB,KAAT,EAAnB;;AACA,UAAI,KAAKxB,IAAL,CAAUyB,OAAd,EAAuB;AACnBC,QAAAA,OAAO,CAACC,GAAR,CAAYrB,QAAQ,CAACsB,QAAT,EAAZ;AACH;AACJ,KAZD,EAYGC,IAZH,CAYSvB,QAAD,IAAwB;AAC5BF,MAAAA,QAAQ,CAAC,UAAD,EAAaE,QAAb,CAAR;AACA,WAAKL,MAAL,CAAYsB,MAAZ,CAAmBjB,QAAQ,CAACkB,KAAT,EAAnB;;AACA,UAAI,KAAKxB,IAAL,CAAUyB,OAAd,EAAuB;AACnBC,QAAAA,OAAO,CAACC,GAAR,CAAYrB,QAAQ,CAACsB,QAAT,EAAZ;AACH;;AACDpB,MAAAA,OAAO;AACV,KAnBD,EAmBGsB,KAnBH,CAmBSC,SAAS,IAAI;AAClB3B,MAAAA,QAAQ,CAAC,WAAD,EAAc2B,SAAd,CAAR;AACA,WAAKX,eAAL,CAAqBY,UAArB,CAAgCC,QAAhC;AACA,WAAKhC,MAAL,CAAYsB,MAAZ,CAAmBQ,SAAnB;;AACA,UAAI,KAAK/B,IAAL,CAAUyB,OAAd,EAAuB;AACnBC,QAAAA,OAAO,CAACC,GAAR,CAAY,oBAAZ;AACH;;AACD,WAAKL,IAAL,CAAUd,OAAV;AACH,KA3BD;AA4BH;;AA1D+B","sourcesContent":["// @flow\nimport OptionsRepository from \"../Repository/OptionsRepository\";\nimport UrlsRepository from \"../Repository/UrlsRepository\";\nimport Pa11yRepository from \"../Repository/Pa11yRepository\";\nimport Logger from \"../Utility/Logger\";\nimport Args from \"../Model/Args\";\nimport Url from \"../Model/Url\";\nimport Progress from \"../Model/Progress\";\n\n// noinspection JSUnusedGlobalSymbols\nexport default class A11yController {\n    args: Args;\n    logger: Logger;\n    urls: Url[];\n    pa11yRepository: Pa11yRepository;\n\n    constructor(args: Args) {\n        this.args = args;\n        this.logger = new Logger(args);\n    }\n\n    start(callback: function = (event, progress) => {}): Promise<void> {\n        return new Promise((resolve, reject) => {\n            this.args.output.doesFolderExist();\n            // Load the option.\n            let optionsRepository = new OptionsRepository(this.args);\n            let option = optionsRepository.getOption();\n\n            // Load the urls to test.\n            let urlsRepository = new UrlsRepository(option, this.args);\n            this.urls = urlsRepository.findAll();\n\n            // Run tests.\n            this.pa11yRepository = new Pa11yRepository(option, this.args);\n\n            this.test(callback, resolve);\n        });\n    }\n\n    test(callback: function = (event, progress) => {}, resolve: function = () => {}) {\n        this.pa11yRepository.test(this.urls, (progress: Progress) => {\n            callback('start', progress);\n            this.logger.report(progress.toLog());\n            if (this.args.verbose) {\n                console.log(progress.toString());\n            }\n        }, (progress: Progress) => {\n            callback('progress', progress);\n            this.logger.report(progress.toLog());\n            if (this.args.verbose) {\n                console.log(progress.toString());\n            }\n        }).then((progress: Progress) => {\n            callback('complete', progress);\n            this.logger.report(progress.toLog());\n            if (this.args.verbose) {\n                console.log(progress.toString());\n            }\n            resolve();\n        }).catch(exception => {\n            callback('exception', exception);\n            this.pa11yRepository.currentUrl.addError();\n            this.logger.report(exception);\n            if (this.args.verbose) {\n                console.log('!!!!!Exception!!!!');\n            }\n            this.test(resolve);\n        });\n    }\n}"],"file":"A11yController.js"}