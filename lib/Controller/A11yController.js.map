{"version":3,"sources":["../../src/Controller/A11yController.js"],"names":["A11yController","constructor","args","logger","Logger","start","callback","event","progress","Promise","resolve","reject","output","doesFolderExist","optionsRepository","OptionsRepository","option","getOption","urlsRepository","UrlsRepository","urls","findAll","pa11yRepository","Pa11yRepository","test","report","toLog","verbose","console","log","toString","then","catch","exception","currentUrl","addError"],"mappings":"6FACA,0FACA,oFACA,sFACA,iEACA,2DACA,yDACA,mE,kFAEA;AACe,KAAMA,CAAAA,cAAe,CAMhCC,WAAW,CAACC,IAAD,CAAa,CACpB,KAAKA,IAAL,CAAYA,IAAZ,CACA,KAAKC,MAAL,CAAc,GAAIC,gBAAJ,CAAWF,IAAX,CACjB,CAEDG,KAAK,EAA8D,IAA7DC,CAAAA,QAA6D,2DAAxC,CAACC,KAAD,CAAQC,QAAR,GAAqB,CAAE,CAAiB,CAC/D,MAAO,IAAIC,CAAAA,OAAJ,CAAY,CAACC,OAAD,CAAUC,MAAV,GAAqB,CACpC,KAAKT,IAAL,CAAUU,MAAV,CAAiBC,eAAjB,GACA;AACA,GAAIC,CAAAA,iBAAiB,CAAG,GAAIC,2BAAJ,CAAsB,KAAKb,IAA3B,CAAxB,CACA,GAAIc,CAAAA,MAAM,CAAGF,iBAAiB,CAACG,SAAlB,EAAb,CAEA;AACA,GAAIC,CAAAA,cAAc,CAAG,GAAIC,wBAAJ,CAAmBH,MAAnB,CAA2B,KAAKd,IAAhC,CAArB,CACA,KAAKkB,IAAL,CAAYF,cAAc,CAACG,OAAf,EAAZ,CAEA;AACA,KAAKC,eAAL,CAAuB,GAAIC,yBAAJ,CAAoBP,MAApB,CAA4B,KAAKd,IAAjC,CAAvB,CAEA,KAAKsB,IAAL,CAAUlB,QAAV,CAAoBI,OAApB,CACH,CAdM,CAeV,CAEDc,IAAI,EAA6E,IAA5ElB,CAAAA,QAA4E,2DAAvD,CAACC,KAAD,CAAQC,QAAR,GAAqB,CAAE,CAAgC,IAA9BE,CAAAA,OAA8B,2DAAV,IAAM,CAAE,CAAE,CAC7E,KAAKY,eAAL,CAAqBE,IAArB,CAA0B,KAAKJ,IAA/B,CAAsCZ,QAAD,EAAwB,CACzDF,QAAQ,CAAC,OAAD,CAAUE,QAAV,CAAR,CACA,KAAKL,MAAL,CAAYsB,MAAZ,CAAmBjB,QAAQ,CAACkB,KAAT,EAAnB,EACA,GAAI,KAAKxB,IAAL,CAAUyB,OAAd,CAAuB,CACnBC,OAAO,CAACC,GAAR,CAAYrB,QAAQ,CAACsB,QAAT,EAAZ,CACH,CACJ,CAND,CAMItB,QAAD,EAAwB,CACvBF,QAAQ,CAAC,UAAD,CAAaE,QAAb,CAAR,CACA,KAAKL,MAAL,CAAYsB,MAAZ,CAAmBjB,QAAQ,CAACkB,KAAT,EAAnB,EACA,GAAI,KAAKxB,IAAL,CAAUyB,OAAd,CAAuB,CACnBC,OAAO,CAACC,GAAR,CAAYrB,QAAQ,CAACsB,QAAT,EAAZ,CACH,CACJ,CAZD,EAYGC,IAZH,CAYSvB,QAAD,EAAwB,CAC5BF,QAAQ,CAAC,UAAD,CAAaE,QAAb,CAAR,CACA,KAAKL,MAAL,CAAYsB,MAAZ,CAAmBjB,QAAQ,CAACkB,KAAT,EAAnB,EACA,GAAI,KAAKxB,IAAL,CAAUyB,OAAd,CAAuB,CACnBC,OAAO,CAACC,GAAR,CAAYrB,QAAQ,CAACsB,QAAT,EAAZ,CACH,CACDpB,OAAO,EACV,CAnBD,EAmBGsB,KAnBH,CAmBSC,SAAS,EAAI,CAClB3B,QAAQ,CAAC,WAAD,CAAc2B,SAAd,CAAR,CACA,KAAKX,eAAL,CAAqBY,UAArB,CAAgCC,QAAhC,GACA,KAAKhC,MAAL,CAAYsB,MAAZ,CAAmBQ,SAAnB,EACA,GAAI,KAAK/B,IAAL,CAAUyB,OAAd,CAAuB,CACnBC,OAAO,CAACC,GAAR,CAAY,oBAAZ,CACH,CACD,KAAKL,IAAL,CAAUd,OAAV,CACH,CA3BD,CA4BH,CA1D+B,C","sourcesContent":["// @flow\nimport OptionsRepository from \"../Repository/OptionsRepository\";\nimport UrlsRepository from \"../Repository/UrlsRepository\";\nimport Pa11yRepository from \"../Repository/Pa11yRepository\";\nimport Logger from \"../Utility/Logger\";\nimport Args from \"../Model/Args\";\nimport Url from \"../Model/Url\";\nimport Progress from \"../Model/Progress\";\n\n// noinspection JSUnusedGlobalSymbols\nexport default class A11yController {\n    args: Args;\n    logger: Logger;\n    urls: Url[];\n    pa11yRepository: Pa11yRepository;\n\n    constructor(args: Args) {\n        this.args = args;\n        this.logger = new Logger(args);\n    }\n\n    start(callback: function = (event, progress) => {}): Promise<void> {\n        return new Promise((resolve, reject) => {\n            this.args.output.doesFolderExist();\n            // Load the option.\n            let optionsRepository = new OptionsRepository(this.args);\n            let option = optionsRepository.getOption();\n\n            // Load the urls to test.\n            let urlsRepository = new UrlsRepository(option, this.args);\n            this.urls = urlsRepository.findAll();\n\n            // Run tests.\n            this.pa11yRepository = new Pa11yRepository(option, this.args);\n\n            this.test(callback, resolve);\n        });\n    }\n\n    test(callback: function = (event, progress) => {}, resolve: function = () => {}) {\n        this.pa11yRepository.test(this.urls, (progress: Progress) => {\n            callback('start', progress);\n            this.logger.report(progress.toLog());\n            if (this.args.verbose) {\n                console.log(progress.toString());\n            }\n        }, (progress: Progress) => {\n            callback('progress', progress);\n            this.logger.report(progress.toLog());\n            if (this.args.verbose) {\n                console.log(progress.toString());\n            }\n        }).then((progress: Progress) => {\n            callback('complete', progress);\n            this.logger.report(progress.toLog());\n            if (this.args.verbose) {\n                console.log(progress.toString());\n            }\n            resolve();\n        }).catch(exception => {\n            callback('exception', exception);\n            this.pa11yRepository.currentUrl.addError();\n            this.logger.report(exception);\n            if (this.args.verbose) {\n                console.log('!!!!!Exception!!!!');\n            }\n            this.test(resolve);\n        });\n    }\n}"],"file":"A11yController.js"}